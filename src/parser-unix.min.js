function e(e){return!(e.length<2)&&!!~o.indexOf(e.charAt(0))}function n(){f++,h.hasOwnProperty(L)?h[L]++:(h[L]=1,WScript.Echo("[;"+ ++l+"]="+g)),WScript.Echo("[#'"+g+"']="+h[L]+"\n[?'"+g+"']=1\n[?'"+g+"'"+h[L]+"]=1\n[-'"+g+"']="+P+"\n[-'"+g+"'"+h[L]+"]="+P),s&&WScript.Echo("[`"+L+"`"+h[L]+"]="+g+"\n[`"+L+"`]="+g)}Array.prototype.indexOf=function(e){for(var n=0;n<this.length;n++)if(this[n]===e)return n;return-1},RegExp.escapePattern=/[-\/\\^$*+?.()|[\]{}]/g,RegExp.escape=function(e){return e.replace(RegExp.escapePattern,"\\$&")};var t=WScript.Arguments,r=new ActiveXObject("WScript.Shell"),c=r.Environment("Process")("JABCLAP_EXPECT_VALUE_FROM"),s=parseInt(r.Environment("Process")("JABCLAP_CASE_SENSITIVE"));isNaN(s)&&(s=!0);var a=parseInt(r.Environment("Process")("JABCLAP_FLAG_BUNDLING"));isNaN(a)&&(a=!0);var o=r.Environment("Process")("JABCLAP_KEY_INDICATOR")||"-",p=r.Environment("Process")("JABCLAP_PAIR_DELIMITER")||"= ",E=(s?c:c.toLowerCase()).split(" "),h={},S=!1,A=0,f=0,l=0,v=/^\s+$/.test(o);for(i=0;i<t.length;i++){var W=t.Item(i);if(WScript.Echo("[@"+(i+1)+"]="+W),"--"!==W)if(!S||(S=!1,e(W)))if(!v&&e(W)){var P=W.charAt(0),m=W.slice(1),x=W.search(new RegExp("["+RegExp.escape(p)+"]")),N=W.charAt(x),g=~x?W.slice(1,x):m,L=g.toLowerCase(),O=~x?m.slice(x):"";if(~E.indexOf(s?g:L))n(),O?WScript.Echo("['"+g+"']="+O+"\n['"+g+"'"+h[L]+"]="+O):(WScript.Echo("['"+g+"']="),~p.indexOf(" ")&&(S=!0));else if(a&&/[a-z0-9]/i.test(W.charAt(1)))for(var u=0;u<m.length&&(g=m.charAt(u),L=g.toLowerCase(),!/[^a-z0-9]/i.test(g));u++){if(n(),~E.indexOf(g)){(O=m.slice(u+1))?WScript.Echo("['"+g+"']="+O+"\n['"+g+"'"+h[L]+"]="+O):(~p.indexOf(" ")&&(S=!0),WScript.Echo("['"+g+"']="));break}WScript.Echo("['"+g+"']=1\n['"+g+"'"+h[L]+"]=1")}else n(),WScript.Echo("['"+m+"']=1\n['"+m+"'"+h[L]+"]=1")}else WScript.Echo("["+ ++A+"]="+W);else WScript.Echo("[-'"+g+"']="+P+"\n[-'"+g+"'"+h[g]+"]="+P+"\n['"+g+"']="+W+"\n['"+g+"'"+h[g]+"]="+W);else v=!0}var C=new ActiveXObject("Scripting.FileSystemObject"),I=WScript.ScriptName.replace(/\?\.wsf$/i,""),_=WScript.ScriptFullName.replace(/\?\.wsf$/i,"");WScript.Echo("[v]=1.0\n[m]=unix\n[0]="+I+"\n[~n0]="+C.GetBaseName(I)+"\n[~x0]=."+C.GetExtensionName(I)+"\n[~nx0]="+I+"\n[~f0]="+_+"\n[~d0]="+C.GetDriveName(_)+"\n[~dp0]="+C.GetParentFolderName(_)+"\n[#a]="+i+"\n[#@]="+i+"\n[#p]="+A+"\n[#]="+A+"\n[#n]="+f+"\n[#q]="+l+"\n[#;]="+l);
